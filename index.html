<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abrand News CI | Portail d'Actualité Dynamique</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fff; scroll-behavior: smooth; }
        .serif { font-family: 'Playfair Display', serif; }
        .border-ci { border-top: 5px solid #FF8200; border-bottom: 5px solid #009A44; }
        .ticker-container { background: #000; color: #fff; padding: 10px 0; overflow: hidden; position: relative; }
        .ticker-move { display: inline-block; white-space: nowrap; animation: ticker-anim 40s linear infinite; font-weight: 800; font-size: 12px; text-transform: uppercase; }
        @keyframes ticker-anim { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .news-card:hover img { transform: scale(1.03); transition: 0.5s; }
        .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    </style>
</head>

<body class="text-slate-900">

    <div class="ticker-container">
        <div class="ticker-move" id="live-news-ticker">
            Chargement du flux mondial... • Flux SEO Abrand News activé • 
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-6 py-2 flex justify-between items-center text-[10px] font-black uppercase tracking-widest border-b">
        <div id="date-now">...</div>
        <div class="flex gap-6 items-center">
            <div class="relative hidden md:block">
                <input type="text" id="search-bar" placeholder="Scanner la toile..." class="border-b border-black text-xs px-2 focus:outline-none">
            </div>
            <button class="hover:text-orange-500">Se Connecter</button>
            <button class="bg-[#FF8200] text-white px-4 py-1 hover:bg-black transition">S'abonner</button>
        </div>
    </div>

    <header class="max-w-7xl mx-auto py-12 text-center">
        <h1 class="serif text-7xl md:text-9xl font-black tracking-tighter">ABRAND <span class="text-[#FF8200]">CI</span></h1>
        <p class="font-black text-[10px] tracking-[0.6em] text-gray-400">ÉDITION NATIONALE & DIGITALE</p>
    </header>

    <nav class="max-w-7xl mx-auto mb-10 sticky top-0 bg-white z-50">
        <div class="border-ci py-4 flex justify-center gap-6 md:gap-12 text-xs font-black uppercase tracking-tighter px-4 overflow-x-auto">
            <a href="#" class="hover:text-orange-500 transition">Politique</a>
            <a href="#" class="hover:text-orange-500 transition">Économie</a>
            <a href="#" class="hover:text-orange-500 transition">Tech</a>
            <a href="index4.html" class="text-blue-600 border-l pl-6 border-gray-300">✎ DASHBOARD ADMIN</a>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 pb-20">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
            <div class="lg:col-span-8 border-r border-gray-100 pr-0 lg:pr-12">
                <article class="news-card group cursor-pointer">
                    <div class="overflow-hidden mb-8 relative">
                        <img src="https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?auto=format&fit=crop&w=1200" class="w-full h-[600px] object-cover grayscale group-hover:grayscale-0 transition-all duration-700">
                        <div class="absolute top-0 left-0 bg-black text-white px-4 py-2 text-xs font-black italic">À LA UNE</div>
                    </div>
                    <h2 class="serif text-5xl md:text-7xl font-black leading-none mb-6">L'avenir du numérique vert en Côte d'Ivoire.</h2>
                    <p class="text-gray-600 text-xl leading-relaxed mb-8 font-light italic">"Le défi d'Abidjan : concilier croissance tech et respect de l'environnement."</p>
                </article>
            </div>

            <aside class="lg:col-span-4 space-y-12">
                <div class="bg-gray-50 p-6 border-l-4 border-[#009A44]">
                    <h3 class="serif text-2xl font-black mb-6 italic">En Direct</h3>
                    <div id="dynamic-news-list" class="space-y-8"></div>
                </div>
                <div class="bg-black text-white p-10">
                    <h4 class="serif text-2xl mb-4 italic">The Abidjan Brief</h4>
                    <button class="w-full bg-[#FF8200] text-white py-3 font-black text-xs uppercase hover:bg-white hover:text-black transition">S'inscrire</button>
                </div>
            </aside>
        </div>

        <section class="mt-20 border-t-4 border-black pt-16">
            <h2 class="serif text-4xl font-black mb-10 italic">Dernières <span class="text-orange-500">Publications Cloud</span></h2>
            <div id="articles-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <p class="text-center col-span-full py-10 animate-pulse">Connexion à Supabase...</p>
            </div>
        </section>
    </main>

    <footer class="bg-white border-t-8 border-black pt-20 pb-10 px-6 text-center">
        <h2 class="serif text-5xl font-black mb-10">ABRAND <span class="text-orange-500">NEWS</span> CI</h2>
        <p class="text-[9px] text-gray-400 uppercase tracking-widest italic">© 2026 Abrand International • Données en temps réel</p>
    </footer>

    <script>
        // --- CONFIGURATION SUPABASE ---
        const SUPABASE_URL = 'https://vyqmlovhdfxavrtoaupv.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5cW1sb3ZoZGZ4YXZydG9hdXB2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1NjY5NTIsImV4cCI6MjA4NTE0Mjk1Mn0.fq_xqw7oqYpoDJ-52asq0awEgw6ybUlJqISFkmfq-IM';
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // 1. CHARGEMENT DES ARTICLES DEPUIS SUPABASE
        async function loadCloudArticles() {
            const { data: posts, error } = await _supabase
                .from('articles')
                .select('*')
                .eq('status', 'published')
                .order('created_at', { ascending: false });

            const container = document.getElementById('articles-container');
            if (error || !posts || posts.length === 0) {
                container.innerHTML = `<p class="col-span-full text-center text-gray-400 italic py-10">Aucun article publié sur le Cloud.</p>`;
                return;
            }

            container.innerHTML = posts.map(post => `
                <article class="news-card group cursor-pointer border-b lg:border-none pb-6">
                    <div class="overflow-hidden mb-4 relative h-64 bg-gray-100">
                        <img src="${post.image}" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition duration-700">
                        <div class="absolute top-0 right-0 bg-[#FF8200] text-white px-3 py-1 text-[10px] font-black">CLOUD</div>
                    </div>
                    <p class="text-orange-600 font-black text-[10px] uppercase mb-2 tracking-widest">
                        ${new Date(post.created_at).toLocaleDateString('fr-FR')}
                    </p>
                    <h3 class="serif text-2xl font-bold leading-tight group-hover:text-blue-600 transition">${post.title}</h3>
                    <p class="text-sm text-gray-500 mt-3 italic line-clamp-3">${post.content.replace(/<[^>]*>/g, '')}</p>
                    <button class="mt-4 text-[10px] font-black uppercase border-b-2 border-black pb-1">Lire la suite</button>
                </article>
            `).join('');
        }

        // 2. SYSTÈME DE TRACKING (Pour ton Dashboard)
        async function trackPerformance() {
            const startTime = performance.now();
            window.addEventListener('load', async () => {
                const loadTime = ((performance.now() - startTime) / 1000).toFixed(2);
                
                // On met à jour ou on insère les stats de la page d'accueil
                await _supabase.rpc('increment_views', { page_id: 'Accueil', speed: parseFloat(loadTime) });
                // Note : Nécessite une fonction SQL 'increment_views' dans Supabase pour être propre, 
                // sinon on peut faire un update classique ici.
            });
        }

        // 3. UI & DATE
        document.getElementById('date-now').innerText = new Date().toLocaleDateString('fr-FR', { 
            weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
        });

        // Lancement
        window.onload = () => {
            loadCloudArticles();
            trackPerformance();
        };

        // Rafraîchir toutes les 30 secondes pour les nouveaux articles
        setInterval(loadCloudArticles, 30000);
    </script>
</body>
</html>